[2023-12-18 16:54:53,352][flwr][WARNING] - 
Setting `min_available_clients` lower than `min_fit_clients` or
`min_evaluate_clients` can cause the server to fail when there are too few clients
connected to the server. `min_available_clients` must be set to a value larger
than or equal to the values of `min_fit_clients` and `min_evaluate_clients`.

[2023-12-18 16:54:53,353][flwr][INFO] - Starting Flower simulation, config: ServerConfig(num_rounds=50, round_timeout=None)
[2023-12-18 16:54:57,213][flwr][INFO] - Flower VCE: Ray initialized with resources: {'accelerator_type:P100': 1.0, 'object_store_memory': 59704460083.0, 'CPU': 48.0, 'memory': 129310406861.0, 'node:172.16.36.6': 1.0, 'GPU': 2.0, 'node:__internal_head__': 1.0}
[2023-12-18 16:54:57,213][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
[2023-12-18 16:54:57,213][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0.25}
[2023-12-18 16:54:57,225][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
[2023-12-18 16:54:57,225][flwr][INFO] - Initializing global parameters
[2023-12-18 16:54:57,225][flwr][INFO] - Requesting initial parameters from one random client
[2023-12-18 16:55:00,812][flwr][INFO] - Received initial parameters from one random client
[2023-12-18 16:55:00,812][flwr][INFO] - Evaluating initial parameters
[2023-12-18 16:55:05,311][flwr][INFO] - initial parameters (loss, other metrics): 0.11527718253135681, {'accuracy': 0.0965}
[2023-12-18 16:55:05,311][flwr][INFO] - FL starting
[2023-12-18 16:55:05,312][flwr][DEBUG] - fit_round 1: strategy sampled 10 clients (out of 100)
[2023-12-18 16:55:20,697][flwr][DEBUG] - fit_round 1 received 10 results and 0 failures
[2023-12-18 16:55:20,705][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2023-12-18 16:55:22,863][flwr][INFO] - fit progress: (1, 0.11509844396114349, {'accuracy': 0.1187}, 17.551588697000625)
[2023-12-18 16:55:22,863][flwr][DEBUG] - evaluate_round 1: strategy sampled 25 clients (out of 100)
[2023-12-18 16:55:34,757][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 56 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:34,758][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 96 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:34,758][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 56 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:34,758][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 96 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:40,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 99 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:40,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 15 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:41,306][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 99 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:41,311][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 15 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:42,477][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 42 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:42,478][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 42 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:44,779][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 31 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:44,779][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 31 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,526][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 51 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,527][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 46 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,527][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 29 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,527][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 51 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,527][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 46 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,528][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 29 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,531][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 49 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,531][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 41 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,532][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 49 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,533][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 93 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,533][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 41 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,533][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 93 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,614][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 67 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:55:50,615][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 67 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:55:50,616][flwr][DEBUG] - evaluate_round 1 received 12 results and 13 failures
[2023-12-18 16:55:50,617][flwr][WARNING] - No evaluate_metrics_aggregation_fn provided
[2023-12-18 16:55:50,617][flwr][DEBUG] - fit_round 2: strategy sampled 10 clients (out of 100)
[2023-12-18 16:56:02,908][flwr][DEBUG] - fit_round 2 received 10 results and 0 failures
[2023-12-18 16:56:04,755][flwr][INFO] - fit progress: (2, 0.11488258774280548, {'accuracy': 0.1273}, 59.444034164000186)
[2023-12-18 16:56:04,756][flwr][DEBUG] - evaluate_round 2: strategy sampled 25 clients (out of 100)
[2023-12-18 16:56:14,942][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 77 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:16,028][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 77 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:20,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 43 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:21,682][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 43 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:22,849][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 53 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:22,849][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 53 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:25,110][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 44 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:26,198][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 44 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:28,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 40 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:29,547][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 25 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:29,619][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 40 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:29,620][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 25 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:30,788][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 87 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:30,789][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 87 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,128][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 78 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:33,128][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 78 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,130][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 58 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:33,130][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 11 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:33,130][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 58 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,131][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 11 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,132][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 60 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:33,132][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 60 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,218][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 64 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:56:33,218][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 64 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:56:33,219][flwr][DEBUG] - evaluate_round 2 received 13 results and 12 failures
[2023-12-18 16:56:33,220][flwr][DEBUG] - fit_round 3: strategy sampled 10 clients (out of 100)
[2023-12-18 16:56:45,787][flwr][DEBUG] - fit_round 3 received 10 results and 0 failures
[2023-12-18 16:56:47,639][flwr][INFO] - fit progress: (3, 0.1144954986333847, {'accuracy': 0.1224}, 102.32738675700057)
[2023-12-18 16:56:47,639][flwr][DEBUG] - evaluate_round 3: strategy sampled 25 clients (out of 100)
[2023-12-18 16:57:06,458][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 83 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:06,458][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 7 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:06,458][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 83 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:06,459][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 7 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:06,494][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 18 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:07,547][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 18 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:08,674][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 12 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:08,674][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 12 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:09,857][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 29 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:09,857][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 36 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:09,858][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 29 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:09,858][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 36 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:13,374][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 35 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:13,374][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 35 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:15,623][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 58 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:15,625][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 58 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:15,625][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 52 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:15,626][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 24 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:15,626][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 86 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:15,626][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71692, ip=172.16.36.6, actor_id=29663a8ac164b0515857049d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fc8ec0fc5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 52 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:15,626][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71696, ip=172.16.36.6, actor_id=f4cc5e019e02342d541511c101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f876c17c5d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 24 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:15,627][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71695, ip=172.16.36.6, actor_id=109994a74d3d16b4b4d257df01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a038e810>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 86 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
[2023-12-18 16:57:15,628][flwr][ERROR] - Traceback (most recent call last):
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 138, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 414, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 300, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
                   ^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 97 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)

[2023-12-18 16:57:15,629][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
                  ^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate
    return maybe_call_evaluate(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate
    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward
    x = self.pool(F.relu(self.conv1(x)))
                         ^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=71694, ip=172.16.36.6, actor_id=42a0a57553f89e68e726574d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6808c39910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 84, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 97 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run\n    job_results = job_fn(client)\n                  ^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 209, in evaluate\n    return maybe_call_evaluate(\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/client.py", line 243, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 251, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/client.py", line 42, in evaluate\n    loss, accuracy = test(self.model, self.valloader, self.device, verbose=False)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 69, in test\n    outputs = model(images)\n              ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/federated-learning/project3/model.py", line 24, in forward\n    x = self.pool(F.relu(self.conv1(x)))\n                         ^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl\n    return forward_call(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward\n    return self._conv_forward(input, self.weight, self.bias)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/tunguyen/.conda/envs/flower-simulation/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward\n    return F.conv2d(input, weight, bias, self.stride,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nRuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same\n',)
